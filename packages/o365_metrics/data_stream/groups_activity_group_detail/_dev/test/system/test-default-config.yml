input: cel
service: o365_metrics
vars:
  url: http://{{Hostname}}:{{Port}}
  token_url: http://{{Hostname}}:{{Port}}
  azure_tenant_id: "1234"
  client_id: "1234"
  client_secret: "1234"
data_stream:
  vars:
    interval: 5m
    initial_interval: 10
    sync_days: 3
    report_types: 
      - 'Microsoft 365 Groups Activity Group Detail'
assert:
  hit_count: 1
  fields_present:
    - o365.metrics.groups.activity.group.detail.last_activity_date
    - o365.metrics.groups.activity.group.detail.group_display_name
    - o365.metrics.groups.activity.group.detail.group_id
    - o365.metrics.groups.activity.group.detail.group_type
    - o365.metrics.groups.activity.group.detail.owner_principal_name
    - o365.metrics.groups.activity.group.detail.is_deleted
    - o365.metrics.groups.activity.group.detail.member.count
    - o365.metrics.groups.activity.group.detail.external_member.count
    - o365.metrics.groups.activity.group.detail.exchange_received_email.count
    - o365.metrics.groups.activity.group.detail.exchange_mailbox_total_item.count
    - o365.metrics.groups.activity.group.detail.exchange_mailbox_storage_used.byte
    - o365.metrics.groups.activity.group.detail.sharepoint_active_file.count
    - o365.metrics.groups.activity.group.detail.sharepoint_total_file.count
    - o365.metrics.groups.activity.group.detail.sharepoint_site_storage_used.byte
    - o365.metrics.groups.activity.group.detail.yammer_liked_message.count
    - o365.metrics.groups.activity.group.detail.yammer_posted_message.count
    - o365.metrics.groups.activity.group.detail.yammer_read_message.count
    - o365.metrics.groups.activity.group.detail.report.period.day
    - o365.metrics.groups.activity.group.detail.report.refresh_date