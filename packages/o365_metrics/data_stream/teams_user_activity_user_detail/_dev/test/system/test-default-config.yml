input: cel
service: o365_metrics
vars:
  url: http://{{Hostname}}:{{Port}}
  token_url: http://{{Hostname}}:{{Port}}
  azure_tenant_id: "1234"
  client_id: "1234"
  client_secret: "1234"
data_stream:
  vars:
    interval: 5m
assert:
  hit_count: 3
  fields_present:
    - o365.metrics.teams.user.activity.user.detail.user_id
    - o365.metrics.teams.user.activity.user.detail.user_principal_name
    - o365.metrics.teams.user.activity.user.detail.last_activity_date
    - o365.metrics.teams.user.activity.user.detail.is_deleted
    - o365.metrics.teams.user.activity.user.detail.deleted_date
    - o365.metrics.teams.user.activity.user.detail.assigned_products
    - o365.metrics.teams.user.activity.user.detail.team_chat_message.count
    - o365.metrics.teams.user.activity.user.detail.private_chat_message.count
    - o365.metrics.teams.user.activity.user.detail.call.count
    - o365.metrics.teams.user.activity.user.detail.meeting.count
    - o365.metrics.teams.user.activity.user.detail.meetings_organized.count
    - o365.metrics.teams.user.activity.user.detail.meetings_attended.count
    - o365.metrics.teams.user.activity.user.detail.scheduled_one_time_meetings_organized.count
    - o365.metrics.teams.user.activity.user.detail.scheduled_one_time_meetings_attended.count
    - o365.metrics.teams.user.activity.user.detail.scheduled_recurring_meetings_organized.count
    - o365.metrics.teams.user.activity.user.detail.scheduled_recurring_meetings_attended.count
    - o365.metrics.teams.user.activity.user.detail.audio_duration.formatted
    - o365.metrics.teams.user.activity.user.detail.video_duration.formatted
    - o365.metrics.teams.user.activity.user.detail.screen_share_duration.formatted
    - o365.metrics.teams.user.activity.user.detail.audio_duration.seconds
    - o365.metrics.teams.user.activity.user.detail.video_duration.seconds
    - o365.metrics.teams.user.activity.user.detail.screen_share_duration.seconds
    - o365.metrics.teams.user.activity.user.detail.has_other_action
    - o365.metrics.teams.user.activity.user.detail.urgent_messages.count
    - o365.metrics.teams.user.activity.user.detail.post_messages.count
    - o365.metrics.teams.user.activity.user.detail.reply_messages.count
    - o365.metrics.teams.user.activity.user.detail.tenant_display_name
    - o365.metrics.teams.user.activity.user.detail.shared_channel_tenant_display_names
    - o365.metrics.teams.user.activity.user.detail.is_licensed
    - o365.metrics.teams.user.activity.user.detail.report.period.day
    - o365.metrics.teams.user.activity.user.detail.report.refresh_date
